# Task Management System

This project provides an API for deleting, creating, updating and listing tasks and uses [Lumen](https://lumen.laravel.com/docs) framework.
More info and documentation provided [here](#Documentation).

[![CI](https://github.com/santiagoibarzabal/taskmanagementsystem/actions/workflows/.ci.yml/badge.svg)](https://github.com/santiagoibarzabal/taskmanagementsystem/actions/workflows/.ci.yml)


## Tools

- [Docker](https://docs.docker.com/engine/reference/commandline/docker/) and [Docker compose](https://docs.docker.com/compose/)
- [Lumen](https://lumen.laravel.com/docs)
- [PHP 8.2](https://www.php.net/releases/8.2/en.php)
- [MSQL:8.0.31](https://dev.mysql.com/doc/refman/8.0/en/)
- [PHPUnit](https://docs.phpunit.de/en/10.5/)
- [NGINX](https://www.nginx.com/)
- [PHP-FPM](https://www.php.net/manual/en/install.fpm.php)

## Running the app

### Requirements
- Docker CLI and Docker compose are necessary to serve the API and the Database locally.

### Build and run docker containers
```
docker compose build
docker compose up -d
```
- All interactions via CLI with the application will need to be executed within Docker. The following command executes bash within the php container. 
```
docker compose exec api bash
```

### Setup Environment Variables. 
- Copy the .env.example file to .env
- Lumen does not provide the key:generate artisan command but instead the following script can be used to generate the key. Once the key is obtained is should be place in APP_KEY of .env
```
 php -r "echo base64_encode(random_bytes(32)), PHP_EOL;"
```

### Execute database migrations
```
docker compose exec api php artisan migrate
```

### Seed database
```
docker compose exec api php artisan db-seed
```

## Running the tests
```
docker compose exec api ./vendor/bin/phpunit
```

## Local development
- Please execute migrations and seeders as detailed above in order. Once that is achieved, an API token can be obtained by using the API Login route ([Docs](#Documentation)).
- Use DBeaver, MySQLWorkbench or mysql via CLI to obtain the necessary information from each table for each request. 

## Documentation

#### API Design
- Use the following link to access the [API Documentation](https://www.postman.com/aviation-cosmonaut-19644470/workspace/public-workspace/documentation/19283025-cd03076f-1b16-41c4-9a5b-b627e5f5335c)

- The solution follows Hexagonal Architecture with 3 modules (Task, User, Status) inside the main bounded context(Task management).
- Each module contains 3 folders:
  - Domain: Business logic, interfaces, value objects and aggregates.
  - Application: Use cases and DTOs.
  - Infrastructure: MySQL repositories and API HTTP Controllers.
- Other important aspects of the solution are:
  - AuthServiceProvider and Authenticate middleware are used to facilitate authentication/authorization. 
  - Taking advantage of the Lumen/Laravel framework, AppServiceProvider is used to bind domain interfaces to specific infrastructure classes. 

#### DB Design
- A commented MySQL structure dump (generated by php:artisan schema:dump) is available at database/schema/mysql-schema-commented.sql and contains additional comments apart from the auto-generated comments.
